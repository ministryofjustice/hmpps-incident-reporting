{% extends "../partials/layout.njk" %}
{% set pageTitle = applicationName + " - Home" %}
{% set mainClasses = "app-container govuk-body" %}

{% from "govuk/components/table/macro.njk" import govukTable %}

{% block content %}
  {% set rows = [] %}
  {% for inc in incidents %}
    {% set rows = (rows.push(
      [
      { html: "<a href='/incident/" + inc.id + "/'>" + inc.title + "</a>" },
      { text: inc.description },
      { text: nameMappings[inc.modifiedBy] },
      { text: inc.modifiedAt },
      { text: inc.reports.length }
      ]
    ), rows) %}
  {% endfor %}

  <div>
  {{ govukTable({
    caption: "Incident events",
    captionClasses: "govuk-table__caption--l",
    firstCellIsHeader: true,
    head: [
      {
        text: "Title"
      },
      {
        text: "Description"
      },
      {
        text: "Modified By"
      },
      {
        text: "Modified At"
      },
      {
        text: "Number of reports"
      }
    ],
    rows: rows
  }) }}
  </div>

{% endblock %}
