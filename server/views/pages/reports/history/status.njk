{% extends "partials/layout.njk" %}

{% from "govuk/components/back-link/macro.njk" import govukBackLink %}
{% from "moj/components/timeline/macro.njk" import mojTimeline %}

{% set pageTitle = applicationName + " - Report status history" %}
{% set bodyClasses = "app-status-history" %}

{% block beforeContent %}
  {{ super() }}

  {{ govukBackLink({
    text: "Back",
    href: "/reports/" + report.id
  }) }}
{% endblock %}

{% block content %}

  <h1 class="govuk-heading-l">
    Incident reference {{ report.reportReference }} â€“ status history
  </h1>

  {% set items = [] %}
  {% for item in report.historyOfStatuses %}
    {% set _ = items.push({
      label: {
        text: statusLookup[item.status] or item.status
      },
      datetime: {
        timestamp: item.changedAt,
        type: "datetime"
      },
      byline: {
        text: usersLookup[item.changedBy].name or item.changedBy
      },
      text: ""
    }) %}
  {% endfor %}

  {{ mojTimeline({
    items: items
  }) }}

{% endblock %}
