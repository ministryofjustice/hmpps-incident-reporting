{% from "govuk/components/error-message/macro.njk" import govukErrorMessage %}
{% from "govuk/components/fieldset/macro.njk" import govukFieldset %}
{% from "govuk/components/hint/macro.njk" import govukHint %}
{% from "govuk/components/input/macro.njk" import govukInput %}

{% macro renderTimeFields(fieldName, field, options, values, errors) %}
  {% set fieldPrefix = "_" + fieldName %}
  {% set hintId = fieldPrefix + "-hint" %}
  {% set errorId = fieldPrefix + "-error" %}

  <div id="{{ fieldName }}__form-group" class="govuk-form-group {% if errors[fieldName] %}govuk-form-group--error{% endif %}">
    {% set describedBy = hintId %}
    {% if errors[fieldName] %}
      {% set describedBy = describedBy + " " + errorId %}
    {% endif %}

    {% call govukFieldset({
      describedBy: describedBy,
      legend: {
        text: field.label,
        classes: "govuk-fieldset__legend--m"
      }
    }) %}

      {% if field.hint %}
        {{ govukHint({
          id: hintId,
          text: field.hint
        }) }}
      {% endif %}

      {% if errors[fieldName] %}
        {{ govukErrorMessage({
          id: errorId,
          text: errors[fieldName].message
        }) }}
      {% endif %}

      {% set timeInputFieldClasses = "govuk-date-input__input govuk-input--width-2" %}
      {% if errors[fieldName] %}
        {% set timeInputFieldClasses = timeInputFieldClasses + " govuk-input--error" %}
      {% endif %}

      <div id="{{ fieldName }}" class="govuk-date-input">
        <div class="govuk-date-input__item">
          {% set hoursFieldName = fieldPrefix + "-hours" %}
          {{ govukInput({
            name: hoursFieldName,
            id: hoursFieldName,
            label: {
              text: "Hours",
              classes: "govuk-date-input__label"
            },
            classes: timeInputFieldClasses,
            inputmode: "numeric",
            value: values[hoursFieldName]
          }) }}
        </div>
        <div class="govuk-date-input__item">
          {% set minutesFieldName = fieldPrefix + "-minutes" %}
          {{ govukInput({
            name: minutesFieldName,
            id: minutesFieldName,
            label: {
              text: "Minutes",
              classes: "govuk-date-input__label"
            },
            classes: timeInputFieldClasses,
            inputmode: "numeric",
            value: values[minutesFieldName]
          }) }}
        </div>
      </div>

    {% endcall %}
  </div>

{% endmacro %}
